<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tạo QR Đẹp - Team QR Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.6.0/lib/qr-code-styling.js"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f7f8fa; padding: 32px; max-width: 520px; margin: auto;}
    h1 { text-align: center; color: #3056d3; }
    input, textarea, select { width: 100%; padding: 8px; margin: 10px 0; border-radius: 6px; border: 1px solid #bbb;}
    button { padding: 10px 24px; border: none; border-radius: 6px; background: #3056d3; color: white; font-size: 16px; cursor:pointer;}
    .qr-box {text-align:center; margin: 24px 0;}
    label {font-weight: bold;}
    #qrbox canvas, #qrbox img { border-radius: 12px; box-shadow: 0 2px 8px #0002;}
    .guide {
      background: #e5f1fb;
      color: #234e7e;
      border-radius: 10px;
      padding: 20px 18px;
      margin-top: 32px;
      font-size: 15px;
      box-shadow: 0 1px 8px #0001;
    }
    .guide ul {margin: 10px 0 10px 20px;}
    .guide code {background: #d6eaff; padding: 2px 5px; border-radius: 4px;}
    .row { display: flex; align-items: center; gap: 12px; }
    .row input[type="color"] { width: 50px; height: 36px; padding: 2px;}
    .row label {margin-bottom:0;}
  </style>
</head>
<body>
  <h1>Tạo QR Đẹp</h1>
  <label>Nội dung hoặc link muốn tạo QR:</label>
  <textarea id="qrinput" rows="2" placeholder="Nhập nội dung..."></textarea>

  <div class="row">
    <label for="qrcolor">Màu QR:</label>
    <input type="color" id="qrcolor" value="#3056d3">
  </div>

  <div class="row">
    <label for="bgcolor">Màu nền:</label>
    <input type="color" id="bgcolor" value="#ffffff">
    <label style="font-weight:normal;">
      <input type="checkbox" id="transparentBG" style="width:auto; margin-right:4px;"> Trong suốt
    </label>
  </div>

  <label>Logo (PNG nhỏ, tuỳ chọn):</label>
  <input type="file" id="logoUpload" accept="image/png">
  <div id="logoName" style="color:#3056d3;font-size:13px;margin-bottom:10px;"></div>

  <label>Bo góc QR:</label>
  <select id="dotstyle">
    <option value="rounded">Bo tròn (Rounded)</option>
    <option value="dots">Chấm (Dots)</option>
    <option value="square">Vuông (Square)</option>
    <option value="classy">Classy</option>
    <option value="classy-rounded">Classy Rounded</option>
    <option value="extra-rounded">Bo cực tròn (Extra Rounded)</option>
  </select>

  <button onclick="genQR()">Tạo QR</button>
  <div class="qr-box" id="qrbox"></div>
  <button onclick="downloadQR()">Tải QR về máy</button>

  <div class="guide">
    <b>Hướng dẫn sử dụng QR Generator:</b>
    <ul>
      <li>Nhập <b>nội dung</b> hoặc <b>link</b> bạn muốn mã hoá QR vào ô trên cùng.</li>
      <li>Chọn <b>màu QR</b> và <b>màu nền</b> (bấm "Trong suốt" nếu không muốn nền).</li>
      <li>Nếu muốn gắn <b>logo</b> cho QR, <b>upload file PNG</b> nhỏ (tối ưu &lt;100px).</li>
      <li>Chọn kiểu <b>bo góc</b> QR cho đẹp, hiện đại.</li>
      <li>Bấm <b>Tạo QR</b> để xem kết quả ngay bên dưới.</li>
      <li>Bấm <b>Tải QR về máy</b> để lưu file PNG về thiết bị.</li>
    </ul>
    <b>Lưu ý:</b>
    <ul>
      <li>QR code này là <b>tĩnh</b>, miễn phí, không hết hạn.</li>
      <li>Bạn có thể dùng trên mọi thiết bị, in ấn thoải mái.</li>
      <li>Nếu cần hỗ trợ custom template/logo, vui lòng liên hệ Admin.</li>
    </ul>
  </div>

  <script>
    let qr = null;
    let logoDataUrl = null;

    // Sự kiện đổi màu nền: chọn trong suốt thì disable input color
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('transparentBG').addEventListener('change', function() {
        let bgcolor = document.getElementById('bgcolor');
        if(this.checked) {
          bgcolor.disabled = true;
        } else {
          bgcolor.disabled = false;
        }
      });
      // Xử lý upload logo file
      document.getElementById('logoUpload').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file && file.type === "image/png") {
          const reader = new FileReader();
          reader.onload = function(event) {
            logoDataUrl = event.target.result;
            document.getElementById('logoName').innerText = file.name;
          };
          reader.readAsDataURL(file);
        } else {
          logoDataUrl = null;
          document.getElementById('logoName').innerText = "";
        }
      });
    });

    function genQR() {
      const text = document.getElementById('qrinput').value.trim();
      const color = document.getElementById('qrcolor').value;
      const bgcolor = document.getElementById('bgcolor').value;
      const transparent = document.getElementById('transparentBG').checked;
      const dotstyle = document.getElementById('dotstyle').value;
      let bgOpt = transparent ? 'rgba(0,0,0,0)' : bgcolor;
      if (!text) { alert('Vui lòng nhập nội dung!'); return; }
      document.getElementById('qrbox').innerHTML = '';

      qr = new QRCodeStyling({
        width: 320,
        height: 320,
        data: text,
        dotsOptions: { color: color, type: dotstyle },
        backgroundOptions: { color: bgOpt },
        image: logoDataUrl || undefined,
        imageOptions: { crossOrigin: "anonymous", margin: 8 }
      });
      qr.append(document.getElementById('qrbox'));
    }
    function downloadQR() {
      if (qr) qr.download({ name: "qr-code", extension: "png" });
    }
  </script>
</body>
</html>
